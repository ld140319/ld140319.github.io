<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="代码规范与技巧,代码技巧,">





  <link rel="alternate" href="/atom.xml" title="搬运工 + 践行者" type="application/atom+xml">






<meta name="description" content="优雅注释之道 原文地址：https://yq.aliyun.com/articles/603241  一、Best Practice注释应该声明代码的高层次意图，而非明显的细节反例1234567891011121314151617181920212223242526/** * generate signature by code, the algorithm is as follows: * 1.">
<meta name="keywords" content="代码规范与技巧,代码技巧">
<meta property="og:type" content="article">
<meta property="og:title" content="优雅注释之道">
<meta property="og:url" content="http://blog.com/2019/08/12/优雅注释之道/index.html">
<meta property="og:site_name" content="搬运工 + 践行者">
<meta property="og:description" content="优雅注释之道 原文地址：https://yq.aliyun.com/articles/603241  一、Best Practice注释应该声明代码的高层次意图，而非明显的细节反例1234567891011121314151617181920212223242526/** * generate signature by code, the algorithm is as follows: * 1.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://blog.com/2019/08/12/优雅注释之道/1529536083719-b7060341-15b1-4618-aa1a-70af951b12dd.png">
<meta property="og:image" content="http://blog.com/2019/08/12/优雅注释之道/1529478737335-9f9da201-1680-4566-80b3-2f4b011612e5.png">
<meta property="og:updated_time" content="2019-08-12T15:02:48.622Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="优雅注释之道">
<meta name="twitter:description" content="优雅注释之道 原文地址：https://yq.aliyun.com/articles/603241  一、Best Practice注释应该声明代码的高层次意图，而非明显的细节反例1234567891011121314151617181920212223242526/** * generate signature by code, the algorithm is as follows: * 1.">
<meta name="twitter:image" content="http://blog.com/2019/08/12/优雅注释之道/1529536083719-b7060341-15b1-4618-aa1a-70af951b12dd.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.com/2019/08/12/优雅注释之道/">





  <title>优雅注释之道 | 搬运工 + 践行者</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">搬运工 + 践行者</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">记录学习的技能和遇到的问题</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.com/2019/08/12/优雅注释之道/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="刘泽明">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="搬运工 + 践行者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">优雅注释之道</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-12T12:12:57+08:00">
                2019-08-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/代码规范与技巧/" itemprop="url" rel="index">
                    <span itemprop="name">代码规范与技巧</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/代码规范与技巧/代码技巧/" itemprop="url" rel="index">
                    <span itemprop="name">代码技巧</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="优雅注释之道"><a href="#优雅注释之道" class="headerlink" title="优雅注释之道"></a>优雅注释之道</h1><blockquote>
<p>原文地址：<a href="https://yq.aliyun.com/articles/603241" target="_blank" rel="noopener">https://yq.aliyun.com/articles/603241</a></p>
</blockquote>
<h2 id="一、Best-Practice"><a href="#一、Best-Practice" class="headerlink" title="一、Best Practice"></a>一、Best Practice</h2><h3 id="注释应该声明代码的高层次意图，而非明显的细节"><a href="#注释应该声明代码的高层次意图，而非明显的细节" class="headerlink" title="注释应该声明代码的高层次意图，而非明显的细节"></a>注释应该声明代码的高层次意图，而非明显的细节</h3><h4 id="反例"><a href="#反例" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * generate signature by code, the algorithm is as follows:</span><br><span class="line"> * 1.sort the http params, if you use java, you can easily use treeMap data structure</span><br><span class="line"> * 2.join the param k-v</span><br><span class="line"> * 3.use hmac-sha1 encrypt the specified string</span><br><span class="line"> *</span><br><span class="line"> * @param params request params</span><br><span class="line"> * @param secret auth secret</span><br><span class="line"> * @return secret sign</span><br><span class="line"> * @throws Exception  exception</span><br><span class="line"> */</span><br><span class="line">public static String generateSignature(Map&lt;String, Object&gt; params, String secret) throws Exception &#123;</span><br><span class="line">    final StringBuilder paramStr = new StringBuilder();</span><br><span class="line">    final Map&lt;String, Object&gt; sortedMap = new TreeMap&lt;&gt;(params);</span><br><span class="line">    for (Map.Entry&lt;String, Object&gt; entry : sortedMap.entrySet()) &#123;</span><br><span class="line">        paramStr.append(entry.getKey());</span><br><span class="line">        paramStr.append(entry.getValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Mac hmac = Mac.getInstance(&quot;HmacSHA1&quot;);</span><br><span class="line">    SecretKeySpec sec = new SecretKeySpec(secret.getBytes(), &quot;HmacSHA1&quot;);</span><br><span class="line">    hmac.init(sec);</span><br><span class="line">    byte[] digest = hmac.doFinal(paramStr.toString().getBytes());</span><br><span class="line"></span><br><span class="line">    return new String(new Hex().encode(digest), &quot;UTF-8&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>上文方法用于根据参数生成签名，注释中详细描述了签名算法的实现步骤，这其实就是过度描述代码明显细节</p>
<h4 id="正例"><a href="#正例" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * generate signature by params and secret, used for computing signature for http request.</span><br><span class="line">  *</span><br><span class="line">  * @param params request params</span><br><span class="line">  * @param secret auth secret</span><br><span class="line">  * @return secret sign</span><br><span class="line">  * @throws Exception  exception</span><br><span class="line">  */</span><br><span class="line"> public static String generateSignature(Map&lt;String, Object&gt; params, String secret) throws Exception &#123;</span><br><span class="line">     final StringBuilder paramStr = new StringBuilder();</span><br><span class="line">     final Map&lt;String, Object&gt; sortedMap = new TreeMap&lt;&gt;(params);</span><br><span class="line">     for (Map.Entry&lt;String, Object&gt; entry : sortedMap.entrySet()) &#123;</span><br><span class="line">         paramStr.append(entry.getKey());</span><br><span class="line">         paramStr.append(entry.getValue());</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     Mac hmac = Mac.getInstance(&quot;HmacSHA1&quot;);</span><br><span class="line">     SecretKeySpec sec = new SecretKeySpec(secret.getBytes(), &quot;HmacSHA1&quot;);</span><br><span class="line">     hmac.init(sec);</span><br><span class="line">     byte[] digest = hmac.doFinal(paramStr.toString().getBytes());</span><br><span class="line"></span><br><span class="line">     return new String(new Hex().encode(digest), &quot;UTF-8&quot;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li><strong>注释一定是表达代码之外的东西，代码可以包含的内容，注释中一定不要出现</strong></li>
<li><strong>如果有必要注释，请注释意图（why），而不要去注释实现（how)，大家都会看代码</strong></li>
</ul>
<h3 id="在文件-类级别使用全局注释来解释所有部分如何工作"><a href="#在文件-类级别使用全局注释来解释所有部分如何工作" class="headerlink" title="在文件/类级别使用全局注释来解释所有部分如何工作"></a>在文件/类级别使用全局注释来解释所有部分如何工作</h3><h4 id="正例-1"><a href="#正例-1" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * Helpers for &#123;@code java.lang.System&#125;.</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * If a system property cannot be read due to security restrictions, the corresponding field in this class will be set</span><br><span class="line"> * to &#123;@code null&#125; and a message will be written to &#123;@code System.err&#125;.</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * #ThreadSafe#</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * @since 1.0</span><br><span class="line"> * @version $Id: SystemUtils.java 1583482 2014-03-31 22:54:57Z niallp $</span><br><span class="line"> */</span><br><span class="line">public class SystemUtils &#123;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>通常每个文件或类都应该有一个全局注释来概述该类的作用</p>
<h3 id="公共api需要添加注释，其它代码谨慎使用注释"><a href="#公共api需要添加注释，其它代码谨慎使用注释" class="headerlink" title="公共api需要添加注释，其它代码谨慎使用注释"></a>公共api需要添加注释，其它代码谨慎使用注释</h3><h4 id="反例-1"><a href="#反例-1" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> *</span><br><span class="line"> * @author yzq</span><br><span class="line"> * @date 2017</span><br><span class="line"> */</span><br><span class="line">public interface KeyPairService &#123;</span><br><span class="line"></span><br><span class="line">    PlainResult&lt;KeyPairInfoModel&gt; createKeyPair(KeyPairCreateParam createParam);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h4><p>以上接口提供<code>dubbo rpc</code>服务属于公共<code>api</code>，以二方包的方式提供给调用方，虽然代码简单缺少了接口概要描述及方法注释等基本信息。</p>
<h4 id="正例-2"><a href="#正例-2" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * dubbo service: key pair rpc service api.</span><br><span class="line"> *</span><br><span class="line"> * @author yzq</span><br><span class="line"> * @date 2017/02/22</span><br><span class="line"> */</span><br><span class="line">public interface KeyPairService &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * create key pair info.</span><br><span class="line">     *</span><br><span class="line">     * @param createParam key pair create param</span><br><span class="line">     * @return BaseResult</span><br><span class="line">     */</span><br><span class="line">    PlainResult&lt;KeyPairInfoModel&gt; createKeyPair(KeyPairCreateParam createParam);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p><strong>公共api一定要有注释，类文件使用类注释，公共接口方法用方法注释</strong></p>
<h3 id="在注释中用精心挑选的输入输出例子进行说明"><a href="#在注释中用精心挑选的输入输出例子进行说明" class="headerlink" title="在注释中用精心挑选的输入输出例子进行说明"></a>在注释中用精心挑选的输入输出例子进行说明</h3><h4 id="正例-3"><a href="#正例-3" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * &lt;p&gt;Checks if CharSequence contains a search character, handling &#123;@code null&#125;.</span><br><span class="line"> * This method uses &#123;@link String#indexOf(int)&#125; if possible.&lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;A &#123;@code null&#125; or empty (&quot;&quot;) CharSequence will return &#123;@code false&#125;.&lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * &lt;pre&gt;</span><br><span class="line"> * StringUtils.contains(null, *)    = false</span><br><span class="line"> * StringUtils.contains(&quot;&quot;, *)      = false</span><br><span class="line"> * StringUtils.contains(&quot;abc&quot;, &apos;a&apos;) = true</span><br><span class="line"> * StringUtils.contains(&quot;abc&quot;, &apos;z&apos;) = false</span><br><span class="line"> * &lt;/pre&gt;</span><br><span class="line"> *</span><br><span class="line"> * @param seq  the CharSequence to check, may be null</span><br><span class="line"> * @param searchChar  the character to find</span><br><span class="line"> * @return true if the CharSequence contains the search character,</span><br><span class="line"> *  false if not or &#123;@code null&#125; string input</span><br><span class="line"> * @since 2.0</span><br><span class="line"> * @since 3.0 Changed signature from contains(String, int) to contains(CharSequence, int)</span><br><span class="line"> */</span><br><span class="line">public static boolean contains(final CharSequence seq, final int searchChar) &#123;</span><br><span class="line">    if (isEmpty(seq)) &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    return CharSequenceUtils.indexOf(seq, searchChar, 0) &gt;= 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h4><p><strong>对于公共的方法尤其是通用的工具类方法提供输入输出的例子往往比任何语言都有力</strong></p>
<h3 id="注释一定要描述离它最近的代码"><a href="#注释一定要描述离它最近的代码" class="headerlink" title="注释一定要描述离它最近的代码"></a>注释一定要描述离它最近的代码</h3><h4 id="反例-2"><a href="#反例-2" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">private Map&lt;String, String&gt; buildInstanceDocumentMap(String version, String instanceId) &#123;</span><br><span class="line">    Map&lt;String, String&gt; instanceDocumentMap = Maps.newLinkedHashMap();</span><br><span class="line"></span><br><span class="line">    Map&lt;String, String&gt; instanceDocumentMapMetadataPart = metaDataService.getInstanceDocument(instanceId, version,</span><br><span class="line">        instanceDocumentMetaKeys);</span><br><span class="line">    instanceDocumentMap.putAll(instanceDocumentMapMetadataPart);</span><br><span class="line">    //the map must remove the old key for instance type</span><br><span class="line">    instanceDocumentMap.put(&quot;instance-type&quot;, instanceDocumentMap.get(&quot;instance/instance-type&quot;));</span><br><span class="line">    instanceDocumentMap.remove(&quot;instance/instance-type&quot;);</span><br><span class="line"></span><br><span class="line">    return instanceDocumentMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-2"><a href="#说明-2" class="headerlink" title="说明"></a>说明</h4><p>该方法有一行代码从<code>map</code>里删除了一个数据，注释放在了<code>put</code>调用之前，而没有直接放在<code>remove</code>之前</p>
<h4 id="正例-4"><a href="#正例-4" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">private Map&lt;String, String&gt; buildInstanceDocumentMap(String version, String instanceId) &#123;</span><br><span class="line">    Map&lt;String, String&gt; instanceDocumentMap = Maps.newLinkedHashMap();</span><br><span class="line"></span><br><span class="line">    Map&lt;String, String&gt; instanceDocumentMapMetadataPart = metaDataService.getInstanceDocument(instanceId, version,</span><br><span class="line">        instanceDocumentMetaKeys);</span><br><span class="line">    instanceDocumentMap.putAll(instanceDocumentMapMetadataPart);</span><br><span class="line">    instanceDocumentMap.put(&quot;instance-type&quot;, instanceDocumentMap.get(&quot;instance/instance-type&quot;));</span><br><span class="line">    //the map must remove the old key for instance type</span><br><span class="line">    instanceDocumentMap.remove(&quot;instance/instance-type&quot;);</span><br><span class="line"></span><br><span class="line">    return instanceDocumentMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-4"><a href="#总结-4" class="headerlink" title="总结"></a>总结</h4><p>注释要放在距离其描述代码最近的位置</p>
<h3 id="注释一定要与代码对应"><a href="#注释一定要与代码对应" class="headerlink" title="注释一定要与代码对应"></a>注释一定要与代码对应</h3><h4 id="反例-3"><a href="#反例-3" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 根据hash过后的id生成指定长度的随机字符串, 且长度不能超过16个字符</span><br><span class="line"> * </span><br><span class="line"> * @param len length of string</span><br><span class="line"> * @param  id id</span><br><span class="line"> * @return String</span><br><span class="line"> */</span><br><span class="line">public static String randomStringWithId(int len, long id) &#123;</span><br><span class="line">    if (len &lt; 1 || len &gt; 32) &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;can&apos;t support to generate 1-32 length random string&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    //use default random seed</span><br><span class="line">    StringBuffer sb = new StringBuffer();</span><br><span class="line">    long genid = id;</span><br><span class="line">    for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">        long pos = genid%32 ;</span><br><span class="line">        genid = genid&gt;&gt;6;</span><br><span class="line">        sb.append(RANDOM_CHAR[(int) pos]);</span><br><span class="line">    &#125;</span><br><span class="line">    return sb.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-3"><a href="#说明-3" class="headerlink" title="说明"></a>说明</h4><p>注释中说明生成随机字符串的长度不能超过16字符，实际代码已经修改为32个字符，此处注释会产生误导读者的副作用</p>
<h4 id="正例-5"><a href="#正例-5" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 根据hash过后的id生成指定长度的随机字符串</span><br><span class="line"> * </span><br><span class="line"> * @param len length of string</span><br><span class="line"> * @param  id id</span><br><span class="line"> * @return String</span><br><span class="line"> */</span><br><span class="line">public static String randomStringWithId(int len, long id) &#123;</span><br><span class="line">    if (len &lt; 1 || len &gt; 32) &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;can&apos;t support to generate 1-32 length random string&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    //use default random seed</span><br><span class="line">    StringBuffer sb = new StringBuffer();</span><br><span class="line">    long genid = id;</span><br><span class="line">    for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">        long pos = genid%32 ;</span><br><span class="line">        genid = genid&gt;&gt;6;</span><br><span class="line">        sb.append(RANDOM_CHAR[(int) pos]);</span><br><span class="line">    &#125;</span><br><span class="line">    return sb.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-5"><a href="#总结-5" class="headerlink" title="总结"></a>总结</h4><ul>
<li>注释一定要与代码对应，通常代码变化对应的注释也要随之改变</li>
<li>若非必要慎用注释，注释同代码一样需要维护更新</li>
</ul>
<h3 id="一定要给常量加注释"><a href="#一定要给常量加注释" class="headerlink" title="一定要给常量加注释"></a>一定要给常量加注释</h3><h4 id="反例-4"><a href="#反例-4" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * define common constants for ebs common component.</span><br><span class="line"> *</span><br><span class="line"> * Author: yzq Date: 16/7/12 Time: 17:44</span><br><span class="line"> */</span><br><span class="line">public final class CommonConstants &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * keep singleton</span><br><span class="line">     */</span><br><span class="line">    private CommonConstants() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static final String BILLING_BID = &quot;26842&quot;;</span><br><span class="line"></span><br><span class="line">    public static final int BILLING_DOMAIN_INTEGRITY_VALID = 1;</span><br><span class="line"></span><br><span class="line">    public static final int BILLING_READYFLAG_START = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="正例-6"><a href="#正例-6" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * define common constants for ebs common component.</span><br><span class="line"> *</span><br><span class="line"> * Author: yzq Date: 16/7/12 Time: 17:44</span><br><span class="line"> */</span><br><span class="line">public final class CommonConstants &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * keep singleton</span><br><span class="line">     */</span><br><span class="line">    private CommonConstants() &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * oms client bid.</span><br><span class="line">     */</span><br><span class="line">    public static final String BILLING_BID = &quot;26842&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * oms billing domain integrity true.</span><br><span class="line">     */</span><br><span class="line">    public static final int BILLING_DOMAIN_INTEGRITY_VALID = 1;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * oms billing readyflag start.</span><br><span class="line">     */</span><br><span class="line">    public static final int BILLING_READYFLAG_START = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-6"><a href="#总结-6" class="headerlink" title="总结"></a>总结</h4><ul>
<li>给每一个常量加一个有效的注释</li>
</ul>
<h3 id="巧用标记（TODO，FIXME，HACK）"><a href="#巧用标记（TODO，FIXME，HACK）" class="headerlink" title="巧用标记（TODO，FIXME，HACK）"></a>巧用标记（TODO，FIXME，HACK）</h3><ul>
<li><code>TODO</code>有未完成的事项</li>
<li><code>FIXME</code> 代码有已知问题待修复</li>
<li><code>HACK</code> 表示代码有<code>hack</code>逻辑</li>
</ul>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public static String randomStringWithId(int len, long id) &#123;</span><br><span class="line">    // TODO: 2018/6/11 需要将len的合法范围抽象</span><br><span class="line">    if (len &lt; 1 || len &gt; 32) &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;can&apos;t support to generate 1-32 length random string&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    //use default random seed</span><br><span class="line">    StringBuffer sb = new StringBuffer();</span><br><span class="line">    long genid = id;</span><br><span class="line">    for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">        long pos = genid%32 ;</span><br><span class="line">        genid = genid&gt;&gt;6;</span><br><span class="line">        sb.append(RANDOM_CHAR[(int) pos]);</span><br><span class="line">    &#125;</span><br><span class="line">    return sb.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="配置标记"><a href="#配置标记" class="headerlink" title="配置标记"></a>配置标记</h4><p>可以扩展<code>IDE</code>修改标记的配置，比如加入解决人，关联缺陷等信息，以<code>IDEA</code>为例修改入口如下：</p>
<p><img src="//blog.com/2019/08/12/优雅注释之道/1529536083719-b7060341-15b1-4618-aa1a-70af951b12dd.png" alt="image.png | left | 747x455"></p>
<h4 id="总结-7"><a href="#总结-7" class="headerlink" title="总结"></a>总结</h4><ul>
<li>巧用<code>TODO</code>、<code>FIXME</code>、<code>HACK</code>等注解标识代码</li>
<li>及时处理所有标识代码，忌滥用</li>
</ul>
<h3 id="适当添加警示注释"><a href="#适当添加警示注释" class="headerlink" title="适当添加警示注释"></a>适当添加警示注释</h3><h4 id="正例-7"><a href="#正例-7" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private BaseResult putReadyFlag(BillingDataContext context, Integer readyFlag) &#123;</span><br><span class="line">    // warn! oms data format require List&lt;Map&lt;String,String&gt;&gt; and the size of it must be one.</span><br><span class="line">    List&lt;Map&lt;String, String&gt;&gt; dataList = Lists.newArrayListWithExpectedSize(1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-4"><a href="#说明-4" class="headerlink" title="说明"></a>说明</h4><p>该方法创建了一个大小固定为1且类型为<code>Map&lt;String,String&gt;</code>的数组链表，这个用法比较奇怪，需要注释说明原因</p>
<h4 id="总结-8"><a href="#总结-8" class="headerlink" title="总结"></a>总结</h4><p><strong>代码里偶尔出现一些非常hack的逻辑且修改会引起较高风险，这个时候需要加注释重点说明</strong></p>
<h3 id="注释掉的代码"><a href="#注释掉的代码" class="headerlink" title="注释掉的代码"></a>注释掉的代码</h3><h4 id="反例-5"><a href="#反例-5" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">private Object buildParamMap(Object request) throws Exception &#123;</span><br><span class="line">    if (List.class.isAssignableFrom(request.getClass())) &#123;</span><br><span class="line">        List&lt;Object&gt; input = (List&lt;Object&gt;)request;</span><br><span class="line">        List&lt;Object&gt; result = new ArrayList&lt;Object&gt;();</span><br><span class="line">        for (Object obj : input) &#123;</span><br><span class="line">            result.add(buildParamMap(obj));</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result = new LinkedHashMap&lt;String, Object&gt;();</span><br><span class="line">    Field[] fields = FieldUtils.getAllFields(request.getClass());</span><br><span class="line">    for (Field field : fields) &#123;</span><br><span class="line">        if (IGNORE_FIELD_LIST.contains(field.getName())) &#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String fieldAnnotationName = field.getAnnotation(ProxyParam.class) != null ? field.getAnnotation(</span><br><span class="line">            ProxyParam.class).paramName() : HttpParamUtil.convertParamName(field.getName());</span><br><span class="line"></span><br><span class="line">        //Object paramValue = FieldUtils.readField(field, request, true);</span><br><span class="line">        //if (paramValue == null) &#123;</span><br><span class="line">        //    continue;</span><br><span class="line">        //&#125;</span><br><span class="line">        //</span><br><span class="line">        //if (BASIC_TYPE_LIST.contains(field.getGenericType().getTypeName())) &#123;</span><br><span class="line">        //    result.put(fieldAnnotationName, String.valueOf(paramValue));</span><br><span class="line">        //&#125; else &#123;</span><br><span class="line">        //    result.put(fieldAnnotationName, this.buildParamMap(paramValue));</span><br><span class="line">        //&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-5"><a href="#说明-5" class="headerlink" title="说明"></a>说明</h4><p>常见套路，为了方便需要的时候重新复用废弃代码，直接注释掉。</p>
<h4 id="正例-8"><a href="#正例-8" class="headerlink" title="正例"></a>正例</h4><p>同上，删除注释部分代码</p>
<h4 id="总结-9"><a href="#总结-9" class="headerlink" title="总结"></a>总结</h4><p><strong>不要在代码保留任何注释掉的代码，版本管理软件如Git可以做的事情不要放到代码里</strong></p>
<h3 id="循规蹈矩式注释"><a href="#循规蹈矩式注释" class="headerlink" title="循规蹈矩式注释"></a>循规蹈矩式注释</h3><h4 id="反例-6"><a href="#反例-6" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 类EcsOperateLogDO.java的实现描述：TODO 类实现描述</span><br><span class="line"> * </span><br><span class="line"> * @author xxx 2012-12-6 上午10:53:21</span><br><span class="line"> */</span><br><span class="line">public class DemoDO implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = -3517141301031994021L;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 主键id</span><br><span class="line">     */</span><br><span class="line">    private Long              id;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 用户uid</span><br><span class="line">     */</span><br><span class="line">    private Long              aliUid;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return the id</span><br><span class="line">     */</span><br><span class="line">    public Long getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @param id the id to set</span><br><span class="line">     */</span><br><span class="line">    public void setId(Long id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return the aliUid</span><br><span class="line">     */</span><br><span class="line">    public Long getAliUid() &#123;</span><br><span class="line">        return aliUid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @param aliUid the aliUid to set</span><br><span class="line">     */</span><br><span class="line">    public void setAliUid(Long aliUid) &#123;</span><br><span class="line">        this.aliUid = aliUid;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-6"><a href="#说明-6" class="headerlink" title="说明"></a>说明</h4><p>分析上述代码可以发现两处注释非常别扭和多余：</p>
<ul>
<li>类注释使用了默认模版, 填充了无效信息</li>
<li>IDE为Getter及Setter方法生成了大量的无效注释</li>
</ul>
<h4 id="正例-9"><a href="#正例-9" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Demo model.</span><br><span class="line"> * @author xxx 2012-12-6 上午10:53:21</span><br><span class="line"> */</span><br><span class="line">public class DemoDO implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = -3517141301031994021L;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 主键id</span><br><span class="line">     */</span><br><span class="line">    private Long              id;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 用户uid</span><br><span class="line">     */</span><br><span class="line">    private Long              aliUid;</span><br><span class="line"></span><br><span class="line">    public Long getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Long id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Long getAliUid() &#123;</span><br><span class="line">        return aliUid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAliUid(Long aliUid) &#123;</span><br><span class="line">        this.aliUid = aliUid;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-10"><a href="#总结-10" class="headerlink" title="总结"></a>总结</h4><ul>
<li>不要保留任何循规蹈矩式注释，比如<code>IDE</code>自动生成的冗余注释</li>
<li>不要产生任何该类注释，可以统一配置<code>IDE</code>达到该效果，推荐使用灵狐插件</li>
</ul>
<h3 id="日志式注释"><a href="#日志式注释" class="headerlink" title="日志式注释"></a>日志式注释</h3><h4 id="反例-7"><a href="#反例-7" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/** 支持xxx   code by xxx 2015/10/11  */</span><br><span class="line">String countryCode = param.getCountyCode();</span><br><span class="line">if(StringUtils.isNotBlank(countryCode) &amp;&amp; !&quot;CN&quot;.equals(countryCode))&#123;</span><br><span class="line">     imageOrderParam.setCountyCode(param.getCountyCode());</span><br><span class="line">     imageOrderParam.setCurrency(param.getCurrency());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-7"><a href="#说明-7" class="headerlink" title="说明"></a>说明</h4><p>修改已有代码很多人会手动添加注释说明修改日期，修改人及修改说明等信息，这些信息大多是冗余的</p>
<h4 id="正例-10"><a href="#正例-10" class="headerlink" title="正例"></a>正例</h4><p>代码同上，删除该注释</p>
<h4 id="总结-11"><a href="#总结-11" class="headerlink" title="总结"></a>总结</h4><p><strong>不要在代码中加入代码的著作信息，版本管理可以完成的事情不要做在代码里</strong></p>
<h3 id="“拐杖注释”"><a href="#“拐杖注释”" class="headerlink" title="“拐杖注释”"></a>“拐杖注释”</h3><h4 id="反例-8"><a href="#反例-8" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * update config map, if the config map is not exist, create it then put the specified key and value, then return it</span><br><span class="line">  * @param key config key</span><br><span class="line">  * @param value config value</span><br><span class="line">  * @return config map</span><br><span class="line">  */</span><br><span class="line"> public Map&lt;String, String&gt; updateConfigWithSpecifiedKV(final String key, final String value) &#123;</span><br><span class="line">     if (StringUtils.isNotBlank(key) || StringUtils.isNotBlank(value)) &#123;</span><br><span class="line">         return Maps.newHashMap();</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     Map&lt;String, String&gt; config = queryConfigMap();</span><br><span class="line">     if (MapUtils.isEmpty(config)) &#123;</span><br><span class="line">         return new HashMap&lt;String, String&gt;() &#123;&#123;</span><br><span class="line">             put(key, value);</span><br><span class="line">         &#125;&#125;;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     config.put(key, value);</span><br><span class="line">     return config;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-8"><a href="#说明-8" class="headerlink" title="说明"></a>说明</h4><p>示例代码简单实现了更新指定<code>map k-v</code>等功能，如果目标<code>map</code>不存在则使用指定<code>k-v</code>初始化一个<code>map</code>并返回，方法名为 <code>updateConfigWithSpecifiedKV</code> ，为了说明方法的完整意图，注释描述了方法的实现逻辑</p>
<h4 id="正例-11"><a href="#正例-11" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * create or update config map with specified k-v.</span><br><span class="line"> *</span><br><span class="line"> * @param value config value</span><br><span class="line"> * @return config map</span><br><span class="line"> */</span><br><span class="line">public Map&lt;String, String&gt; createOrUpdateConfigWithSpecifiedKV(final String key, final String value) &#123;</span><br><span class="line">    if (StringUtils.isNotBlank(key) || StringUtils.isNotBlank(value)) &#123;</span><br><span class="line">        return Maps.newHashMap();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, String&gt; config = queryConfigMap();</span><br><span class="line">    if (MapUtils.isEmpty(config)) &#123;</span><br><span class="line">        return new HashMap&lt;String, String&gt;() &#123;&#123;</span><br><span class="line">            put(key, value);</span><br><span class="line">        &#125;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    config.put(key, value);</span><br><span class="line">    return config;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-12"><a href="#总结-12" class="headerlink" title="总结"></a>总结</h4><p><strong>抛弃“拐杖注释”</strong>，不要给不好的名字加注释，一个好的名字比好的注释更重要</p>
<h3 id="过度html化的注释"><a href="#过度html化的注释" class="headerlink" title="过度html化的注释"></a>过度html化的注释</h3><h4 id="反例-9"><a href="#反例-9" class="headerlink" title="反例"></a>反例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * used for indicate the field will be used as a http param, the http request methods include as follows:</span><br><span class="line"> * &lt;li&gt;Get&lt;/li&gt;</span><br><span class="line"> * &lt;li&gt;Post&lt;/li&gt;</span><br><span class="line"> * &lt;li&gt;Connect&lt;/li&gt;</span><br><span class="line"> *</span><br><span class="line"> * the proxy param will be parsed, see &#123;@link ProxyParamBuilder&#125;.</span><br><span class="line"> *</span><br><span class="line"> * @author yzq</span><br><span class="line"> * @date 2017/12/08</span><br><span class="line"> */</span><br><span class="line">@Target(ElementType.FIELD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">public @interface ProxyParam &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * the value indicate the proxy app name, such as houyi.</span><br><span class="line">     *</span><br><span class="line">     * @return proxy app name</span><br><span class="line">     */</span><br><span class="line">    String proxyApp() default &quot;houyi&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * proxy request mapping http param.</span><br><span class="line">     *</span><br><span class="line">     * @return http param</span><br><span class="line">     */</span><br><span class="line">    String paramName();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * the value indicate if the param is required.</span><br><span class="line">     *</span><br><span class="line">     * @return if this param is required</span><br><span class="line">     */</span><br><span class="line">    boolean isRequired() default true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="说明-9"><a href="#说明-9" class="headerlink" title="说明"></a>说明</h4><p>类注释使用了大量的<code>html</code>标签用来描述，实际效果并没有带来收益反而增加阅读难度</p>
<h4 id="正例-12"><a href="#正例-12" class="headerlink" title="正例"></a>正例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * used for indicate the field will be used as a http param.</span><br><span class="line"> *</span><br><span class="line"> * @author yzq</span><br><span class="line"> * @date 2017/12/08</span><br><span class="line"> */</span><br><span class="line">@Target(ElementType.FIELD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@Documented</span><br><span class="line">public @interface ProxyParam &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * the value indicate the proxy app name, such as houyi.</span><br><span class="line">     *</span><br><span class="line">     * @return proxy app name</span><br><span class="line">     */</span><br><span class="line">    String proxyApp() default &quot;houyi&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * proxy request mapping http param.</span><br><span class="line">     *</span><br><span class="line">     * @return http param</span><br><span class="line">     */</span><br><span class="line">    String paramName();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * the value indicate if the param is required.</span><br><span class="line">     *</span><br><span class="line">     * @return if this param is required</span><br><span class="line">     */</span><br><span class="line">    boolean isRequired() default true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-13"><a href="#总结-13" class="headerlink" title="总结"></a>总结</h4><ul>
<li><strong>普通业务注释谨慎使用html标签，它不会给你带来明显收益，只会徒增阅读难度</strong></li>
<li><strong>如果是公共api且用于生成javadoc可以考虑加入必要的html标签，比如链接，锚点等</strong></li>
</ul>
<h2 id="二、编程语言注释实践"><a href="#二、编程语言注释实践" class="headerlink" title="二、编程语言注释实践"></a>二、编程语言注释实践</h2><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><h4 id="文件-类注释规范"><a href="#文件-类注释规范" class="headerlink" title="文件/类注释规范"></a>文件/类注释规范</h4><p>目前<code>IDE</code>安装 <a href="https://yq.aliyun.com/go/articleRenderRedirect?url=http%3A%2F%2Fide.alibaba-inc.com%2F" target="_blank" rel="noopener">灵狐</a> 后会自动配置<code>IDE</code>的<code>file templates</code>为如下格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @author $&#123;USER&#125;</span><br><span class="line"> * @date $&#123;YEAR&#125;/$&#123;MONTH&#125;/$&#123;DAY&#125;</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<p><strong>强烈建议使用如上配置，统一、简洁就是最好。</strong>如果有特殊需要需要定制类注释可以参考下图：</p>
<p><img src="//blog.com/2019/08/12/优雅注释之道/1529478737335-9f9da201-1680-4566-80b3-2f4b011612e5.png" alt="image.png | left | 747x455"></p>
<h4 id="方法注释"><a href="#方法注释" class="headerlink" title="方法注释"></a>方法注释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/**  </span><br><span class="line"> * xxx</span><br><span class="line"> * </span><br><span class="line"> * @param </span><br><span class="line"> * @param </span><br><span class="line"> * @return </span><br><span class="line"> * @throws </span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<p><code>IDE</code>提供了统一的方法注释模版，无需手动配置，好的方法注释应该包括以下内容：</p>
<ul>
<li>方法的描述，重点描述该方法用来做什么，有必要可以加一个输入输出的例子</li>
<li>参数描述</li>
<li>返回值描述</li>
<li>异常描述</li>
</ul>
<p>举个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Converts a &lt;code&gt;byte[]&lt;/code&gt; to a String using the specified character encoding.</span><br><span class="line"> *</span><br><span class="line"> * @param bytes</span><br><span class="line"> *            the byte array to read from</span><br><span class="line"> * @param charsetName</span><br><span class="line"> *            the encoding to use, if null then use the platform default</span><br><span class="line"> * @return a new String</span><br><span class="line"> * @throws UnsupportedEncodingException</span><br><span class="line"> *             If the named charset is not supported</span><br><span class="line"> * @throws NullPointerException</span><br><span class="line"> *             if the input is null</span><br><span class="line"> * @deprecated use &#123;@link StringUtils#toEncodedString(byte[], Charset)&#125; instead of String constants in your code</span><br><span class="line"> * @since 3.1</span><br><span class="line"> */</span><br><span class="line">@Deprecated</span><br><span class="line">public static String toString(final byte[] bytes, final String charsetName) throws UnsupportedEncodingException &#123;</span><br><span class="line">    return charsetName != null ? new String(bytes, charsetName) : new String(bytes, Charset.defaultCharset());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="块注释与行注释"><a href="#块注释与行注释" class="headerlink" title="块注释与行注释"></a>块注释与行注释</h4><ul>
<li>单行代码注释使用行注释 //</li>
<li>多行代码注释使用块注释 /<em> </em>/</li>
</ul>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h4 id="文件注释"><a href="#文件注释" class="headerlink" title="文件注释"></a>文件注释</h4><ul>
<li>重点描述文件的作用及使用方式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">bazaar script collection.</span><br><span class="line"></span><br><span class="line">init_resource_entry, used for init bazaar resource such as vpc, vsw, sg, proxy ecs and so on.</span><br><span class="line"></span><br><span class="line">user manual:</span><br><span class="line">1. modify ecs.conf config your key, secret, and region.</span><br><span class="line">2. run bazaar_tools.py script, this process will last a few minutes，then it will generate a init.sql file.</span><br><span class="line">3. use idb4 submit your ddl changes.</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>
<h4 id="类注释"><a href="#类注释" class="headerlink" title="类注释"></a>类注释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">ecs sdk client, used for xxx.</span><br><span class="line"></span><br><span class="line">Attributes:</span><br><span class="line">    client:</span><br><span class="line">    access_key: </span><br><span class="line">    access_secret:</span><br><span class="line">    region:</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>类应该在其定义下有一个用于描述该类的文档字符串</li>
<li>类公共属性应该加以描述</li>
</ul>
<h4 id="函数注释"><a href="#函数注释" class="headerlink" title="函数注释"></a>函数注释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">def fetch_bigtable_rows(big_table, keys, other_silly_variable=None):</span><br><span class="line">    &quot;&quot;&quot;Fetches rows from a Bigtable.</span><br><span class="line"></span><br><span class="line">    Retrieves rows pertaining to the given keys from the Table instance</span><br><span class="line">    represented by big_table.  Silly things may happen if</span><br><span class="line">    other_silly_variable is not None.</span><br><span class="line"></span><br><span class="line">    Args:</span><br><span class="line">        big_table: An open Bigtable Table instance.</span><br><span class="line">        keys: A sequence of strings representing the key of each table row</span><br><span class="line">            to fetch.</span><br><span class="line">        other_silly_variable: Another optional variable, that has a much</span><br><span class="line">            longer name than the other args, and which does nothing.</span><br><span class="line"></span><br><span class="line">    Returns:</span><br><span class="line">        A dict mapping keys to the corresponding table row data</span><br><span class="line">        fetched. Each row is represented as a tuple of strings. For</span><br><span class="line">        example:</span><br><span class="line"></span><br><span class="line">        &#123;&apos;Serak&apos;: (&apos;Rigel VII&apos;, &apos;Preparer&apos;),</span><br><span class="line">         &apos;Zim&apos;: (&apos;Irk&apos;, &apos;Invader&apos;),</span><br><span class="line">         &apos;Lrrr&apos;: (&apos;Omicron Persei 8&apos;, &apos;Emperor&apos;)&#125;</span><br><span class="line"></span><br><span class="line">        If a key from the keys argument is missing from the dictionary,</span><br><span class="line">        then that row was not found in the table.</span><br><span class="line"></span><br><span class="line">    Raises:</span><br><span class="line">        IOError: An error occurred accessing the bigtable.Table object.</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Args</code>:列出每个参数的名字, 并在名字后使用一个冒号和一个空格, 分隔对该参数的描述.如果描述太长超过了单行80字符,使用2或者4个空格的悬挂缩进(与文件其他部分保持一致). 描述应该包括所需的类型和含义. 如果一个函数接受<em>foo(可变长度参数列表)或者**bar (任意关键字参数), 应该详细列出</em>foo和**bar.</li>
<li><code>Returns</code>: 描述返回值的类型和语义. 如果函数返回None, 这一部分可以省略</li>
<li><code>Raises</code>:列出与接口有关的所有异常</li>
</ul>
<h4 id="多行注释与行尾注释"><a href="#多行注释与行尾注释" class="headerlink" title="多行注释与行尾注释"></a>多行注释与行尾注释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># We use a weighted dictionary search to find out where i is in</span><br><span class="line"># the array.  We extrapolate position based on the largest num</span><br><span class="line"># in the array and the array size and then do binary search to</span><br><span class="line"># get the exact number.</span><br><span class="line"></span><br><span class="line">if i &amp; (i-1) == 0:        # true iff i is a power of 2</span><br></pre></td></tr></table></figure>
<ul>
<li>复杂操作多行注释描述</li>
<li>比较晦涩的代码使用行尾注释</li>
</ul>
<h3 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h3><h4 id="行注释"><a href="#行注释" class="headerlink" title="行注释"></a>行注释</h4><p>常用注释风格</p>
<h4 id="包注释"><a href="#包注释" class="headerlink" title="包注释"></a>包注释</h4><p>/<strong>/ 通常用于包注释, 作为一个整体提供此包的对应信息，</strong>每个包都应该包含一个doc.go用于描述其信息。**</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">     ecs OpenApi demo，use aliyun ecs sdk manage ecs, this package will provide you function list as follows:</span><br><span class="line"></span><br><span class="line">    DescribeInstances, query your account ecs.</span><br><span class="line">    CreateInstance, create a ecs vm with specified params.</span><br><span class="line"> */</span><br><span class="line">package ecsproxy</span><br></pre></td></tr></table></figure>
<h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p>常用/**/与//，用法基本同Java。</p>
<h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h3><p>只支持 # ，每个文件都包含一个顶层注释，用于阐述版权及概要信息。</p>
<h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>待完善</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/代码规范与技巧/" rel="tag"># 代码规范与技巧</a>
          
            <a href="/tags/代码技巧/" rel="tag"># 代码技巧</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/12/Java函数优雅之道/" rel="next" title="Java函数优雅之道">
                <i class="fa fa-chevron-left"></i> Java函数优雅之道
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/16/处理亿级数据的定时任务，如何缩短执行时间/" rel="prev" title="处理亿级数据的定时任务，如何缩短执行时间">
                处理亿级数据的定时任务，如何缩短执行时间 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">刘泽明</p>
              <p class="site-description motion-element" itemprop="description">做一个懂业务的程序员</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">731</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">394</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">237</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#优雅注释之道"><span class="nav-number">1.</span> <span class="nav-text">优雅注释之道</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、Best-Practice"><span class="nav-number">1.1.</span> <span class="nav-text">一、Best Practice</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注释应该声明代码的高层次意图，而非明显的细节"><span class="nav-number">1.1.1.</span> <span class="nav-text">注释应该声明代码的高层次意图，而非明显的细节</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在文件-类级别使用全局注释来解释所有部分如何工作"><span class="nav-number">1.1.2.</span> <span class="nav-text">在文件/类级别使用全局注释来解释所有部分如何工作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-1"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-1"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#公共api需要添加注释，其它代码谨慎使用注释"><span class="nav-number">1.1.3.</span> <span class="nav-text">公共api需要添加注释，其它代码谨慎使用注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-1"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-1"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-2"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-2"><span class="nav-number">1.1.3.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在注释中用精心挑选的输入输出例子进行说明"><span class="nav-number">1.1.4.</span> <span class="nav-text">在注释中用精心挑选的输入输出例子进行说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-3"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-3"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释一定要描述离它最近的代码"><span class="nav-number">1.1.5.</span> <span class="nav-text">注释一定要描述离它最近的代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-2"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-2"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-4"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-4"><span class="nav-number">1.1.5.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释一定要与代码对应"><span class="nav-number">1.1.6.</span> <span class="nav-text">注释一定要与代码对应</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-3"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-3"><span class="nav-number">1.1.6.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-5"><span class="nav-number">1.1.6.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-5"><span class="nav-number">1.1.6.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一定要给常量加注释"><span class="nav-number">1.1.7.</span> <span class="nav-text">一定要给常量加注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-4"><span class="nav-number">1.1.7.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-6"><span class="nav-number">1.1.7.2.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-6"><span class="nav-number">1.1.7.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#巧用标记（TODO，FIXME，HACK）"><span class="nav-number">1.1.8.</span> <span class="nav-text">巧用标记（TODO，FIXME，HACK）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置标记"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">配置标记</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-7"><span class="nav-number">1.1.8.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#适当添加警示注释"><span class="nav-number">1.1.9.</span> <span class="nav-text">适当添加警示注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-7"><span class="nav-number">1.1.9.1.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-4"><span class="nav-number">1.1.9.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-8"><span class="nav-number">1.1.9.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释掉的代码"><span class="nav-number">1.1.10.</span> <span class="nav-text">注释掉的代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-5"><span class="nav-number">1.1.10.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-5"><span class="nav-number">1.1.10.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-8"><span class="nav-number">1.1.10.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-9"><span class="nav-number">1.1.10.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#循规蹈矩式注释"><span class="nav-number">1.1.11.</span> <span class="nav-text">循规蹈矩式注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-6"><span class="nav-number">1.1.11.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-6"><span class="nav-number">1.1.11.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-9"><span class="nav-number">1.1.11.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-10"><span class="nav-number">1.1.11.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志式注释"><span class="nav-number">1.1.12.</span> <span class="nav-text">日志式注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-7"><span class="nav-number">1.1.12.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-7"><span class="nav-number">1.1.12.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-10"><span class="nav-number">1.1.12.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-11"><span class="nav-number">1.1.12.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#“拐杖注释”"><span class="nav-number">1.1.13.</span> <span class="nav-text">“拐杖注释”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-8"><span class="nav-number">1.1.13.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-8"><span class="nav-number">1.1.13.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-11"><span class="nav-number">1.1.13.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-12"><span class="nav-number">1.1.13.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过度html化的注释"><span class="nav-number">1.1.14.</span> <span class="nav-text">过度html化的注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反例-9"><span class="nav-number">1.1.14.1.</span> <span class="nav-text">反例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-9"><span class="nav-number">1.1.14.2.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正例-12"><span class="nav-number">1.1.14.3.</span> <span class="nav-text">正例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#总结-13"><span class="nav-number">1.1.14.4.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、编程语言注释实践"><span class="nav-number">1.2.</span> <span class="nav-text">二、编程语言注释实践</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Java"><span class="nav-number">1.2.1.</span> <span class="nav-text">Java</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#文件-类注释规范"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">文件/类注释规范</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方法注释"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">方法注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#块注释与行注释"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">块注释与行注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python"><span class="nav-number">1.2.2.</span> <span class="nav-text">Python</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#文件注释"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">文件注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类注释"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">类注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数注释"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">函数注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多行注释与行尾注释"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">多行注释与行尾注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Golang"><span class="nav-number">1.2.3.</span> <span class="nav-text">Golang</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#行注释"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">行注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#包注释"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">包注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript"><span class="nav-number">1.2.4.</span> <span class="nav-text">JavaScript</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shell"><span class="nav-number">1.2.5.</span> <span class="nav-text">Shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其它"><span class="nav-number">1.2.6.</span> <span class="nav-text">其它</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-[object Object]"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘泽明</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
